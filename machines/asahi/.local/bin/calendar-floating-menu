#!/bin/bash
# Launch calentui as a floating terminal window

{
    # Already open? Do nothing
    if hyprctl clients -j | grep -q "WAYBAR-MENU: calentui"; then
        exit 0
    fi

    # Close any other menu that might be open (terminal menus)
    hyprctl clients -j | jq -r '.[] | select(.title | startswith("WAYBAR-MENU:")) | .address' 2>/dev/null | while read addr; do
        hyprctl dispatch closewindow "address:$addr" >/dev/null 2>&1
    done

    # Close LocalSend if open
    localsend_addr=$(hyprctl clients -j | jq -r '.[] | select(.class == "localsend") | .address' 2>/dev/null | head -1)
    if [ -n "$localsend_addr" ]; then
        hyprctl dispatch closewindow "address:$localsend_addr" >/dev/null 2>&1
    fi

    # Clear any existing pin state
    rm -f /tmp/waybar-menu-pinned

    # Launch menu
    foot --title='WAYBAR-MENU: calentui' /home/caleb/.local/bin/calentui
} &

disown
exit 0
