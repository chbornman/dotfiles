#!/bin/bash
# Waybar module for screenshots
# Outputs JSON for waybar, polls for last screenshot

output() {
    local tooltip="Super+P: area | Super+Shift+P: screen | Super+Alt+P: window\nClick: area | Right-click: screen | Middle-click: window\nSaves to ~/Downloads"

    if [ -f /tmp/last-screenshot ]; then
        local last
        last="$(basename "$(cat /tmp/last-screenshot)")"
        tooltip="Last: $last\n$tooltip"
    fi

    printf '{"text": "â¬’", "tooltip": "%s", "class": "idle"}\n' "$tooltip"
}

while true; do
    output
    sleep 5
done
